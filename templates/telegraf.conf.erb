# Telegraf Configuration
#
# THIS FILE IS MANAGED BY PUPPET
#
<% if scope['telegraf::global_tags'] -%>
[global_tags]
<%   scope['telegraf::global_tags'].each do |key, value| -%>
  <%= key %> = "<%= value %>"
<%   end -%>
<% end -%>

[agent]
  hostname = "<%= scope['telegraf::hostname'] %>"
  interval = "<%= scope['telegraf::interval'] %>"
  round_interval = <%= scope['telegraf::round_interval'] %>
  metric_buffer_limit = <%= scope['telegraf::metric_buffer_limit'] %>
  flush_buffer_when_full = <%= scope['telegraf::flush_buffer_when_full'] %>
  collection_jitter = "<%= scope['telegraf::collection_jitter'] %>"
  flush_interval = "<%= scope['telegraf::flush_interval'] %>"
  flush_jitter = "<%= scope['telegraf::flush_jitter'] %>"
  debug = <%= scope['telegraf::debug'] %>
  quiet = <%= scope['telegraf::quiet'] %>

<% if scope['telegraf::outputs'] -%>
#
# OUTPUTS:
#
<%   scope['telegraf::outputs'].each_pair do | output, options | -%>
[[outputs.<%= output %>]]
<%      unless options == nil -%>
<%          options.each do | option, value | -%>
  <%= option -%> = <% if value.is_a?(String) %>"<%= value %>"<% else %><%= value %><% end %>
<%          end -%>
<%      end -%>
<%   end -%>
<% end -%>

<% if scope['telegraf::inputs'] -%>
#
# INPUTS:
#
<%   scope['telegraf::inputs'].each_pair do | input, options | -%>
[[inputs.<%= input %>]]
<%      unless options == nil -%>
<%          options.each do | option, value | -%>
  <%= option -%> = <% if value.is_a?(String) %>"<%= value %>"<% else %><%= value %><% end %>
<%          end -%>
<%      end -%>
<%   end -%>
<% end -%>
